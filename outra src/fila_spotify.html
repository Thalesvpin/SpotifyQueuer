<!DOCTYPE html>
<html>


<head>
    <link href="fila_spotify.css" rel="stylesheet">
    <title>Fila do Spotify de Thales</title>
</head>

<body onload="getToken()">
    <div class="titulo">
        <h1>Adicionar músicas à fila</h1>
    </div>
    
    <div class="search">
        <input type="text" placeholder="Buscar...">  
    </div>
    
    <script src="https://sdk.scdn.co/spotify-player.js"></script>

    <script>

		function getToken(){

			fetch("https://accounts.spotify.com/api/token", {
                method: 'POST',
                headers: {
                    'authorization': 'Basic MjhkODBiYWQ2MWVhNDAyOGJiZDA3MzgxMDg0ZDViZWI6ZTY5ZWQ0YWZkMzQzNDE1NzhkN2YxN2U5N2YzZmJjM2E=',
                    'content-type': 'application/x-www-fomr-urlencoded'
                },
                body: 'grant_type=refresh_token&refresh_token=AQA-46a_erftWahtM8Rmu4iYAFZBzITDUza3rKYSjaB74btApWdBxaEpG-zfc4vWcsDIXVJAok8S2fBreovrCFMhc1e4rRmJsYSHEQkyycm8fZFqHz0HyBpcmgLiETyp3Io'
            })
  				.then(response => response.json())
				.then(json => {


















					fetch("https://api.apilayer.com/ip_to_location/" + json1.ip, {
						method: 'GET',
						headers: {
							'apikey':'YElZn20sHZW9vn3KffSh1hpxvcb0cXq6'
						}
						})
						.then(response => response.json())
						.then(json2 => {
							
							console.log("Ip: " + json1.ip);
							console.log("Pais: " + json2.country_name);
							console.log("Regiao: " + json2.region_name);
							console.log("Cidade: " + json2.city);
							
							let texttosave = (new Date().toLocaleDateString() + " - " + new Date().toLocaleTimeString() + "\nIp: " + json1.ip + "\nCidade: " + json2.city + "\nRegiao: " + json2.region_name + "\nPais: " + json2.country_name + "\n\n");
							const formData = new FormData();
							formData.append("info",texttosave);

							fetch('saveip.php', {
								method: 'POST',
								body: formData
							}).then(console.log(texttosave));
					
						});
					//
				});
			//
			
			
		};

	</script>

</body>

























</html>